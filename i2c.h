#include<stdio.h>
#include "inc/tm4c123gh6pm.h"

//I2C0SCL 47 PB2 (3)
//I2C0SDA 48 PB3 (3)

//I2C1SCL 47 PA6 (3)
//I2C1SDA 48 PA7 (3)

//I2C2SCL 47 PE4 (3)
//I2C2SDA 48 PE5 (3)

//I2C3SCL 47 PD0 (3)
//I2C3SDA 48 PD1 (3)

void i2c_slave_init(uint8_t address)
{
	//Step 1
	SYSCTL_RCGCI2C_R |= 0X0001;// ENABLE CLOCK TO I2C0
	SYSCTL_RCGCGPIO_R |= 0X0002;// ENABLE CLOCK TO PORT B
	while((SYSCTL_PRGPIO_R & 0x0002) == 0 );//WAIT FOR THE CLOCK ENABLING TO PORT B
	GPIO_PORTB_AFSEL_R |= 0X000C;// CONFIGURE FOR ALTERNATE FUNCTION OF PORTB AS I2C
	GPIO_PORTB_ODR_R |= 0X0008;//SELECT OPEN DRAIN FOR SDA ONLY AS OTHER ONE IS CONNECTED TO ACTIVE PULL UP
	GPIO_PORTB_DEN_R |= 0X000C;// DIGITAL ENABLE FOR PORT B NEEDED FOR ODR
	GPIO_PORTB_PCTL_R = (GPIO_PORTB_PCTL_R & 0XFFFF00FF)+0X00003300;// PINMUX: TO WRITE 0X03 FOR GPIO PIN2 AND PIN3 FOR SCL AND SDA
	GPIO_PORTB_AMSEL_R &=0X0000C;//DISABLE ANALOG FUNCTIONALITY OF PORT B 2,3
	I2C0_MCR_R = I2C_MCR_SFE;//SLAVE FUNCTION ENABLE;
	I2C0_SCSR_R = 0x01;//ENABLE I2C SLAVE OPERATIONS PAGE 1038
	I2C0_MTPR_R = 0X24;
  I2C0_SOAR_R |= address;	
}
